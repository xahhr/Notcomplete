<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ØªØ¹Ø§ÙÙŠ 63 ğŸŒ¿ â€“ Ø¨Ø¯Ø§ÙŠØ© Ù…Ù† 15 Ù…Ø¬Ù…</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
body{font-family:'Cairo',sans-serif;background:#f8f9fa;color:#222;margin:0;line-height:1.6}
:root{--a:#2ecc71;--w:#f39c12;--d:#e74c3c;--l:#fff;--g:#eee}
header{background:#fff;padding:16px;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:0;z-index:10}
h1{font-size:22px;margin:0;background:linear-gradient(90deg,#2ecc71,#3498db);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.wrap{max-width:1100px;margin:auto;padding:12px}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:16px}
.card{grid-column:span 12;background:var(--l);border-radius:16px;padding:18px;box-shadow:0 4px 20px rgba(0,0,0,0.08)}
@media(min-width:900px){.half{grid-column:span 6}.third{grid-column:span 4}}
.btn{padding:10px 16px;border:none;border-radius:12px;cursor:pointer;margin:4px;font-size:14px}
.btn.a{background:var(--a);color:#fff}.btn.w{background:var(--w);color:#fff}.btn.d{background:var(--d);color:#fff}
.pill{padding:6px 14px;border-radius:30px;background:#e8f5e9;font-size:13px;display:inline-flex;align-items:center;gap:6px}
.bar{height:10px;background:#ddd;border-radius:5px;overflow:hidden}
.bar span{display:block;height:100%;background:linear-gradient(90deg,#3498db,var(--a));transition:0.5s}
.table{width:100%;border-collapse:collapse;font-size:14px}
.table th{background:#f0f8ff;color:#2980b9;padding:12px}
.table td{padding:10px;text-align:center;border-bottom:1px solid #eee}
.supp label{display:flex;align-items:center;gap:12px;padding:10px;background:#f8f9fa;border-radius:10px;margin:6px 0}
.tip{background:#e8f5ff;padding:16px;border-radius:12px;border-right:5px solid #3498db;margin:12px 0;font-size:15px}
.mood{padding:10px 16px;border-radius:20px;cursor:pointer}
.mood.active{background:#d5f5e3;border:2px solid var(--a)}
</style>
</head>
<body>

<header>
  <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">
    <h1>ØªØ¹Ø§ÙÙŠ 63 ğŸŒ¿ â€“ Ø¨Ø¯Ø§ÙŠØ© Ù…Ù† 15 Ù…Ø¬Ù… Ø¥ÙŠØ²ÙˆØ¨ÙŠÙƒÙ„ÙˆÙ†</h1>
    <div>
      <button class="btn" id="openInv">Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ğŸ“¦</button>
      <button class="btn" id="prevDay">â¬… Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button class="btn" id="nextDay">Ø§Ù„ØªØ§Ù„ÙŠ â¡</button>
      <button class="btn w" id="resetStart">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ğŸ“…</button>
      <button class="btn a" id="exportPdf">PDF ğŸ“„</button>
      <button class="btn" onclick="document.body.classList.toggle('night')">ğŸŒ™ Ù„ÙŠÙ„ÙŠ</button>
    </div>
  </div>
  <div style="margin-top:12px;display:flex;gap:12px;flex-wrap:wrap;align-items:center">
    <span class="pill">Ø¨Ø¯Ø¡: <b id="startDateLabel">Ø§Ù„ÙŠÙˆÙ…</b></span>
    <span class="pill">ÙŠÙˆÙ… <b id="dayIdxLabel">1</b>/63</span>
    <span class="pill">Ø£Ø³Ø¨ÙˆØ¹ <b id="weekLabel">1</b></span>
    <span class="pill" style="background:#d5f5e3">ØªÙ‚Ø¯Ù… <b id="progressText">0%</b></span>
    <div class="bar" style="flex:1;min-width:200px"><span id="progressBar" style="width:0%"></span></div>
  </div>
</header>

<div class="wrap">
<div class="grid">

  <div class="card" id="chartCard"><h3>Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø§Ù†Ø³Ø­Ø§Ø¨ ğŸ“‰</h3><canvas id="chart"></canvas></div>

  <div class="card"><h3>Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ÙŠÙˆÙ… ğŸ¯</h3><p id="targetsText" style="font-size:18px"></p></div>

  <div class="card">
    <h3>Ø³Ø¬Ù„ Ø¬Ø±Ø¹Ø§ØªÙƒ âœï¸</h3>
    <table class="table">
      <tr><td>Ø¥ÙŠØ²ÙˆØ¨ÙŠÙƒÙ„ÙˆÙ†</td><td id="t_eso">15</td><td><input type="number" step="0.5" data-k="eso"></td></tr>
      <tr><td>Ø¬Ø§Ø¨Ø§Ø¨Ù†ØªÙŠÙ†</td><td id="t_gab">2200</td><td><input type="number" step="50" data-k="gab"></td></tr>
      <tr><td>Ù…Ù†Ø´Ø·Ø§Øª</td><td id="t_stim">650</td><td><input type="number" step="25" data-k="stim"></td></tr>
      <tr><td>ÙƒØ§ÙÙŠÙŠÙ† â‰¤</td><td id="t_caf">350</td><td><input type="number" step="10" data-k="caf"></td></tr>
    </table>
    <button class="btn a" id="saveDay">Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ… âœ…</button> <span id="saveMsg"></span>
    <button class="btn" id="voiceNote">ğŸ¤ Ù…Ù„Ø§Ø­Ø¸Ø© ØµÙˆØªÙŠØ©</button>
  </div>

  <div class="card">
    <h3>ğŸ’¡ Ù†ØµÙŠØ­Ø© Ø§Ù„ÙŠÙˆÙ… Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ø§Ù†Ø³Ø­Ø§Ø¨</h3>
    <div id="dailyTip" class="tip">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>

  <div class="card half">
    <h3>Ø§Ù„Ù…ÙƒÙ…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ğŸ’Š (Ø¶Ø¹ Ø¹Ù„Ø§Ù…Ø© âœ“)</h3>
    <div class="supp">
      <label><input type="checkbox" id="s1"> Ù…ØºÙ†ÙŠØ³ÙŠÙˆÙ… Ø¬Ù„Ø§ÙŠØ³ÙŠÙ†Ø§Øª 400 Ù…Ø¬Ù…</label>
      <label><input type="checkbox" id="s2"> Ù„Ù€ Ø«ÙŠØ§Ù†ÙŠÙ† 200â€“400 Ù…Ø¬Ù…</label>
      <label><input type="checkbox" id="s3"> Ù…ÙŠÙ„Ø§ØªÙˆÙ†ÙŠÙ† 0.5â€“1 Ù…Ø¬Ù… (Ø¥Ø°Ø§ Ù„Ø²Ù…)</label>
      <label><input type="checkbox" id="s4"> Ø£ÙˆÙ…ÙŠØ¬Ø§-3 Ø¹Ø§Ù„ÙŠ EPA</label>
      <label><input type="checkbox" id="s5"> ÙÙŠØªØ§Ù…ÙŠÙ† Ø¯ 5000 ÙˆØ­Ø¯Ø©</label>
      <label><input type="checkbox" id="s6"> ÙÙŠØªØ§Ù…ÙŠÙ† Ø¨ Ø§Ù„Ù…Ø±ÙƒØ¨</label>
      <label><input type="checkbox" id="s7"> Ø£Ø´ÙˆØ§Ø¬Ù†Ø¯Ø§ Ø£Ùˆ Ø±ÙˆØ¯ÙŠÙˆÙ„Ø§</label>
    </div>
  </div>

  <div class="card half">
    <h3>Ù…Ø²Ø§Ø¬Ùƒ Ø§Ù„ÙŠÙˆÙ… ğŸ˜Š</h3>
    <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
      <span class="pill mood" onclick="setMood(1)">ğŸ˜” Ù…ÙƒØªØ¦Ø¨</span>
      <span class="pill mood" onclick="setMood(2)">ğŸ˜° Ù…ØªÙˆØªØ±</span>
      <span class="pill mood active" onclick="setMood(3)">ğŸ˜ Ø¹Ø§Ø¯ÙŠ</span>
      <span class="pill mood" onclick="setMood(4)">ğŸ™‚ Ø¬ÙŠØ¯</span>
      <span class="pill mood" onclick="setMood(5)">ğŸ˜ Ù…Ù…ØªØ§Ø²</span>
    </div>
    <textarea id="notes" rows="4" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙŠÙˆÙ…... Ø£ÙŠ Ø£Ø¹Ø±Ø§Ø¶ØŸ Ù†ÙˆÙ…ÙƒØŸ"></textarea>
  </div>

  <div class="card">
    <h3>Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ğŸ“¦</h3>
    <table class="table" id="invTable"><tbody></tbody></table>
  </div>

</div>
</div>

<dialog id="invDlg"><form method="dialog">
  <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
  <div id="invForm"></div>
  <div style="margin-top:20px;text-align:left">
    <button class="btn" value="cancel">Ø¥Ù„ØºØ§Ø¡</button>
    <button class="btn a" id="saveInv">Ø­ÙØ¸</button>
  </div>
</form></dialog>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const TOTAL_DAYS = 63;
const LS_START = "t63_start", LS_DATA = "t63_data", LS_INV = "t63_inv";
let day = 1, mood = 3;

// Ø®Ø·Ø© 63 ÙŠÙˆÙ… ØªØ¨Ø¯Ø£ Ù…Ù† 15 Ù…Ø¬Ù… Ø¥ÙŠØ²ÙˆØ¨ÙŠÙƒÙ„ÙˆÙ†
const targets = {
  eso:[0,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,10,10,10,10,10,10,10,8,8,8,8,8,8,8,6,6,6,6,6,6,6,4,4,4,4,4,4,4,2,2,2,1,1,1,0],
  gab:[0,2200,2200,2200,2200,2200,2200,2200,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,1800,1800,1800,1800,1800,1600,1600,1600,1600,1600,1600,1600,1400,1400,1400,1400,1400,1400,1400,1200,1200,1200,1200,1200,1200,1200,1000,1000,1000,1000,1000,1000,1000,800,800,800,800,800,800,800,600,600,600,300,300,300,0],
  stim:[0,650,650,650,650,650,650,650,600,600,600,600,600,600,600,600,600,600,600,600,550,550,550,550,550,500,500,500,500,500,500,500,400,400,400,400,400,400,400,300,300,300,300,300,300,300,200,200,200,200,200,200,200,100,100,100,100,100,100,100,50,50,50,0,0,0,0],
  caf:[0,350,350,350,350,350,350,350,300,300,300,300,300,300,300,300,300,300,300,300,250,250,250,250,250,200,200,200,200,200,200,200,150,150,150,150,150,150,150,100,100,100,100,100,100,100,75,75,75,75,75,75,75,50,50,50,50,50,50,50,30,30,30,10,10,10,0]
};

const tips = [
  "ğŸ’§ Ø§Ø´Ø±Ø¨ 3â€“4 Ù„ØªØ± Ù…Ø§Ø¡ ÙŠÙˆÙ…ÙŠÙ‹Ø§ â€“ ÙŠØ®ÙÙ ÙƒÙ„ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§",
  "ğŸ§˜â€â™‚ï¸ Ù…ØºÙ†ÙŠØ³ÙŠÙˆÙ… Ø¬Ù„Ø§ÙŠØ³ÙŠÙ†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ… = Ø£ÙØ¶Ù„ Ù…Ø³ÙƒÙ† Ù„Ù„Ø¹Ø¶Ù„Ø§Øª ÙˆØ§Ù„Ù‚Ù„Ù‚",
  "ğŸƒâ€â™‚ï¸ 20 Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ø´ÙŠ Ø£Ùˆ ØªÙ…Ø§Ø±ÙŠÙ† Ø®ÙÙŠÙØ© ÙŠÙˆÙ…ÙŠÙ‹Ø§ ØªÙ‚Ù„Ù„ Ø§Ù„Ù‚Ù„Ù‚ Ø¨Ù†Ø³Ø¨Ø© ÙƒØ¨ÙŠØ±Ø©",
  "â˜• ØªØ¬Ù†Ø¨ Ø§Ù„ÙƒØ§ÙÙŠÙŠÙ† Ø¨Ø¹Ø¯ 2 Ø¸Ù‡Ø±Ù‹Ø§ ØªÙ…Ø§Ù…Ù‹Ø§",
  "ğŸ› Ø­Ù…Ø§Ù… Ø¯Ø§ÙØ¦ + Ù…Ù„Ø­ Ø¥Ø¨Ø³ÙˆÙ… = Ø¹Ù„Ø§Ø¬ Ù…Ù†Ø²Ù„ÙŠ Ù…Ù…ØªØ§Ø² Ù„Ù„Ø£Ø±Ù‚",
  "ğŸŒ¬ ØªÙ†ÙØ³ 4-7-8 (4 Ø«ÙˆØ§Ù†ÙŠ Ø´Ù‡ÙŠÙ‚ØŒ 7 Ø­Ø¨Ø³ØŒ 8 Ø²ÙÙŠØ±) ÙŠÙˆÙ‚Ù Ù†ÙˆØ¨Ø§Øª Ø§Ù„Ù‚Ù„Ù‚ ÙÙˆØ±Ù‹Ø§",
  "ğŸŸ Ø£ÙˆÙ…ÙŠØ¬Ø§-3 Ø¹Ø§Ù„ÙŠ EPA ÙŠØ­Ø³Ù† Ø§Ù„Ù…Ø²Ø§Ø¬ Ø®Ù„Ø§Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†",
  "â° Ù†Ø§Ù… ÙˆØ§ØµØ­Ù Ù†ÙØ³ Ø§Ù„Ù…ÙŠØ¹Ø§Ø¯ Ø­ØªÙ‰ Ù„Ùˆ Ù†Ù…Øª 4 Ø³Ø§Ø¹Ø§Øª ÙÙ‚Ø·"
];

function getStart(){let s=localStorage.getItem(LS_START);if(!s){let d=new Date();d.setHours(0,0,0,0);localStorage.setItem(LS_START,d.toISOString());s=d.toISOString()}return new Date(s)}
function getDay(){const s=getStart().getTime(),n=new Date();n.setHours(0,0,0,0);return Math.min(TOTAL_DAYS,Math.max(1,Math.floor((n-s)/86400000)+1))}
function data(){return JSON.parse(localStorage.getItem(LS_DATA)||"{}")}
function saveData(o){localStorage.setItem(LS_DATA,JSON.stringify(o))}
function dayData(d){let a=data();return a[d]||{med:{},sup:{},mood:3,notes:""}}
function saveDay(d,o){let a=data();a[d]=o;saveData(a)}

new Chart(document.getElementById('chart'),{type:'line',data:{labels:Array.from({length:TOTAL_DAYS},(_,i)=>i+1),datasets:[
  {label:'Ø¥ÙŠØ²ÙˆØ¨ÙŠÙƒÙ„ÙˆÙ†',data:targets.eso.slice(1),borderColor:'#e74c3c',tension:.3},
  {label:'Ø¬Ø§Ø¨Ø§Ø¨Ù†ØªÙŠÙ†',data:targets.gab.slice(1).map(v=>v/100),borderColor:'#f39c12',tension:.3},
  {label:'Ù…Ù†Ø´Ø·Ø§Øª',data:targets.stim.slice(1),borderColor:'#3498db',tension:.3}
]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}},maintainAspectRatio:false}});

function render(){
  day = getDay();
  document.getElementById("dayIdxLabel").textContent = day;
  document.getElementById("weekLabel").textContent = Math.ceil(day/7);
  document.getElementById("progressText").textContent = Math.round(day/TOTAL_DAYS*100)+"%";
  document.getElementById("progressBar").style.width = (day/TOTAL_DAYS*100)+"%";
  document.getElementById("startDateLabel").textContent = getStart().toLocaleDateString('ar-EG');

  document.getElementById("t_eso").textContent = targets.eso[day];
  document.getElementById("t_gab").textContent = targets.gab[day];
  document.getElementById("t_stim").textContent = targets.stim[day];
  document.getElementById("t_caf").textContent = targets.caf[day];

  document.getElementById("targetsText").innerHTML = `Ø¥ÙŠØ²ÙˆØ¨ÙŠÙƒÙ„ÙˆÙ† <b>\( {targets.eso[day]}</b> ğŸŒ™ â€¢ Ø¬Ø§Ø¨Ø§Ø¨Ù†ØªÙŠÙ† <b> \){targets.gab[day]}</b> â€¢ Ù…Ù†Ø´Ø·Ø§Øª <b>\( {targets.stim[day]}</b> âš¡ â€¢ ÙƒØ§ÙÙŠÙŠÙ† â‰¤ <b> \){targets.caf[day]}</b> â˜•` +
    (day===63?" <b style='color:#2ecc71'>ğŸ‰ Ø®Ù„Ø§Øµ Ø­Ø±!</b>":"");

  document.getElementById("dailyTip").innerHTML = "ğŸ’¡ <b>Ù†ØµÙŠØ­Ø© Ø§Ù„ÙŠÙˆÙ…:</b> " + tips[(day-1)%tips.length];

  const dd = dayData(day);
  ["eso","gab","stim","caf"].forEach(k=>document.querySelector(`input[data-k=${k}]`).value = dd.med[k]||"");
  document.getElementById("notes").value = dd.notes||"";
  setMood(dd.mood||3);
}
function setMood(m){mood=m;document.querySelectorAll('.mood').forEach((e,i)=>e.classList.toggle('active',i+1===m))}

document.getElementById("saveDay").onclick=()=>{
  const o={med:{},sup:{},mood,mood,notes:document.getElementById("notes").value};
  ["eso","gab","stim","caf"].forEach(k=>o.med[k]=Number(document.querySelector(`input[data-k=${k}]`).value)||null);
  saveDay(day,o);
  document.getElementById("saveMsg").textContent="ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…";
  setTimeout(()=>document.getElementById("saveMsg").textContent="",2000);
};

document.getElementById("prevDay").onclick=()=>{renderDay(Math.max(1,day-1))}
document.getElementById("nextDay").onclick=()=>{renderDay(Math.min(TOTAL_DAYS,day+1))}
function renderDay(d){day=d;render()}

document.getElementById("resetStart").onclick=()=>{
  const s=prompt("ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯ (YYYY-MM-DD) Ø£Ùˆ ÙØ§Ø±Øº Ù„Ù„ÙŠÙˆÙ…:",getStart().toISOString().slice(0,10));
  if(s===null)return;
  const d=s?s+"T00:00:00":(new Date().setHours(0,0,0,0),new Date());
  localStorage.setItem(LS_START,new Date(d).toISOString());
  render();
};

document.getElementById("voiceNote").onclick=()=>{
  if(!('SpeechRecognition' in window||'webkitSpeechRecognition' in window))return alert("Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");
  const r=new (window.SpeechRecognition||window.webkitSpeechRecognition)();
  r.lang="ar-SA";r.onresult=e=>document.getElementById("notes").value+=e.results[0][0].transcript+" ";
  r.start();
};

render();
setInterval(()=>{if(getDay()!==day)render()},60000);
</script>
</body>
</html>